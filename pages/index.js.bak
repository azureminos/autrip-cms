import { Component } from 'react';
import _ from 'lodash';
import axios from 'axios';
import Card from './Card';

class App extends Component {

	static async getInitialProps () {
		const urlGetPackages = `${process.env.API_BASE_URL}/api/travelpackage`;
		let resPackages = await axios.get(urlGetPackages);

		const urlGetMetadata = `${process.env.API_BASE_URL}/api/metadata`;
		let resMetadata = await axios.get(urlGetMetadata);

		return { packages: resPackages.data, filters: resMetadata.data };
	}

	render () {
		const { packages } = this.props;
		const cards = _.map(packages, (p) => {
			return (<Card key={p.id} package={p}/>);
		});
		return (
			<div>
				{cards}
			</div>
		);
	};
}

export default App;
